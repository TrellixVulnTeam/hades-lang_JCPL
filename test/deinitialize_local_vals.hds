import libc as c;
import hades.drop as drop;
struct X {
    val mut message: *Byte;
}

implement drop.Drop for X {
    def drop(this: *mut X): Void {
        c.puts(*this.message);
    }
}

def main(): Void {
    val x1 = X(b"x1");
    val x2 = X(b"x2");
    val mut x3 = x2;
    x3.message = b"x3";

    f();
    c.puts(b"f returned");

    if true {
        val x5 = X(b"x5");
    } else {
        val x5 = X(b"x5_unreachable");
    }
    c.puts(b"branch end");
    c.puts(b"returning from main");
}

def f(): Void {
    c.puts(b"f called");
    val x4 = X(b"x4");
    c.puts(b"returning from f");
}