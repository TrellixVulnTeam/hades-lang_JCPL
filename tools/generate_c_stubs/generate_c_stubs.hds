import libc as c;
import Clang as Clang;
import StubGen.Result as SGResult;
import StubGen.Error as SGError;
import hades.Result as Result;
import StubGen.Flags as SGFlags;

def main(argc: Int, argv: **Byte): Void {
    val result = run(argc, argv);
    if (Result.is_error(result)) {
        result |> Result.get_error |> SGError.dump;
        c.exit(-1);
    } else {
        c.exit(0);
    }
}

def run(argc: Int, argv: **Byte): SGResult.t[Int] {
    val flags_result = SGFlags.parse(argc, argv);
    if (Result.is_error(flags_result)) {
        return flags_result |> Result.get_error |> Result.error;
    }
    val flags = Result.get_value(flags_result);
    return Result.error(SGError.unimplemented());
}